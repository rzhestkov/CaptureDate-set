# CaptureDate-set

## Кратко

Предварительная настройка: **SetDate.ps1** - <u>*Обязательно!*</u>

Запуск: **SetDate.cmd**

## Проблематика

- Метаданные с датой и временем съемки в файлах с фотографиями - это важная, полезная, используемая многими программами информация.

- При сканировании, пересъемке и т.д. метаданные даты и времени съемки получаются текущие.

- Облачные галереи Google photo, Yandex disk проводят сортировку именно по времени съемки, а не по имени файлов. Получается, что фото отображаются в порядке сканирования, что является неудобным и/или неверным.

- При массовом изменении даты съемки, например, в Lightroom и других программах, что я видел, можно изменять даты, но время съемки не изменяется.

- Ручное изменение даты и особенно времени в каждом фото - муторная задача.

## Цели

Сделать так, чтобы сканированные фото имели правильную дату и располагалась в правильном (желаемом) порядке.

## Что делает программа?

- Выбирает из текущей папки файлы с расширениями (на текущий момент)

        "*.psd", "*.jpeg", "*.jpg", "*.arw"

- Сортирует их по имени и выбирает по одному.

- Присваивает новую дату и время.

- Дата - любая желаемая. Она задается в тексте программы.

- Время, начиная с дефолтного `12:01:00`, у каждого следующего файла становится больше на одну минуту.

## Порядок работы

Даты нужно менять перед  импортом в **LightRoom** и другие программы.

Если в качестве исходника негативы, то даты можно начинать менять после экспорта в позитив.

1. Установка

2. Настройка

3. Обработка

### 1. Установка

<u>*Нужно, чтобы в операционной системе было разрешено исполнение PowerShell скриптов. Без этого работать ничего не будет.*</u>

В каталог с фотографиями нужно положить файлы

- exiftool.exe

- SetDate.cmd

- SetDate.ps1

### 2. Настройка

Открыть любым редактором файл **SetDate.ps1**

Изменить строку `$newCaptureDate="2004:05:15"`.

Формат установки даты: "yyyy:mm:dd""

Пример: "1998:12:31"
При желании можно поправить и начальное время. Оно хранится в двух параметрах:

`$startCaptureHour=12` и `$startCaptureMin=1` 

Но я лично эти параметры не меняю, т.к. сканирую старые, очень старые фото и время съемки на них для меня не важно.

### 3. Обработка

Желаемый порядок файлов предварительно должен быть установлен путем переименования файлов. Самый удобный инструмент для этого из тех, что мне встречались - **XnViewMP**.

Обработка запускается вызовом **SetDate.cmd** из папки, где расположены обрабатываемые фото.

После обработки остаются бэкапы файлов с расширениями вида **.psd_original** . Их можно (нужно) удалить потом.

## Ограничения

Поддерживается множество типов файлов, а не только те, что сейчас прописаны в тексте программы. Подробнее нужно смотреть в документации **exiftools**.

<u>*Нужно следить, чтобы файлов в папке для обработки не было слишком много. Т.к. переход на следующие сутки в данном скрипте не обрабатывается.*</u>

## Разное

В графических файлах может храниться множество метаданных в различных системах записи. Причем, зачастую, в одном файле одновременно в разных форматах.

Не нашел другого инструмента с такой же функциональностью, работающего из командной строки, кроме **exiftools**.

Я пробовал на разных файлах разные параметры из большого набора, который есть в **exiftools**. Как оказалось, для данной задачи лучше всего работает `-AllDates=`. Он корректно изменяет максимально количество метаданных, которые хранят дату и время съемки (Capture Date, Time).
